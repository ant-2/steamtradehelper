<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Trade helper</title>
  <style type="text/css">@import url(modules/spreadsheet.css);</style>

  <!-- External libs -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lodash.js/4.13.1/lodash.js"></script>
  <script src="http://code.jquery.com/jquery-1.12.4.min.js"></script>

  <!-- Internal libs -->
  <script src="js/common.js"></script>
  <script src="js/data.js"></script>
  <script src="js/prices.js"></script>
  <script src="modules/spreadsheet.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", init);

    function init() {
      // retrieves data from a server
      var items, dataSupplier, parser, rawPrices;
      try {
        dataSupplier = new BackpacktfDataSupplier();
        rawPrices = dataSupplier.getPrices();
        parser = new PricesApiParser(rawPrices);
        items = parser.parseAllItems();
      } catch (e) {
        console.log('Error in attempt to get data from server. ' + e.name + ": " + e.message);
      }

      var spreadsheet, templates = new SpreadsheetTmpl();
      try {
        spreadsheet = new Spreadsheet({
          styles: {
            container: "sh",
            row: "sh__row"
          },
          rowTitle: _.template(templates.rowTitle),
          rowCell: _.template(templates.rowCell),
          items: items
        });

        document.body.appendChild(spreadsheet.getElem());
      } catch (e) {
        console.log("Error in rendering page content. "+e.name+": "+e.message)
      }
    }
  </script>
</head>

<body>
</body>
</html>